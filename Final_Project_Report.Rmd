---
title: "Final_Project_Report"
author: "Binaya Shrestha, Dongming Li, Molly Buckler, Armando Castillo, John Langenwalter, Muhamad-Imran-Bin Maszeri"
date: "11/21/2020"
output: html_document
---

```{r message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(lubridate)
library(readxl)
library(rvest)
library(scales)
library(reshape)
library(RColorBrewer)
setwd(getwd())
```

## Description of background and questions raised

    Background description:
    Questiion list: 1. Has Lyme disease increased from 1992?(Overall and states)
                    2. Which states have the highest rate of Lyme Disease?
                    3. What changes have happened to the average temperatureï¼ˆOverall and states)?
                    4. Is there any association with the rate of Lyme disease and the changes to temperature?
                    5. What changes have happened to the average temperature?
                    6. Is there any association with the rate of Lyme disease and the changes to precipitation?
                    

## The pipeline for obtaining and cleaning the dataset

## The exploratory analysis with a few featured infographics

    Temperature part: The change of average temperature in the U.S. and each states may affect the rate of Lymn disease.
    1. Average Temperature of 50 states over 20 years
```{r message=FALSE, warning=FALSE, echo=FALSE}
Temp<-read.csv("AveTempState.csv")
Temp2<-Temp %>%
  group_by(State)%>%
  summarise(Ave_Temp=mean(Ave_Temp))
ggplot(Temp2,aes(y=State,weight=Ave_Temp)) + geom_bar() + 
  labs(title = "Average Temperature of 50 states over 20 years",x="Temperature",y="State") + 
  theme(plot.title = element_text(hjust = 0.5),axis.title.x = element_text(face = "bold"),axis.title.y = element_text(face = "bold"),axis.text.y = element_text())

```

    2. Average Temperature in the U.S.
```{r message=FALSE, warning=FALSE, echo=FALSE}
Temp3<- Temp%>%
  group_by(Year)%>%
  summarise(Ave_Temp=mean(Ave_Temp))
ggplot(Temp3,aes(x=Year,weight=Ave_Temp)) + geom_bar() +
  labs(title = "Average Temperature over 20 years") + theme(plot.title = element_text(hjust = 0.5))
```
## Steps for data wrangling and visualization

    Temperature part:
    1. See how has the average temperature in the United States changed over 20 years.
```{r message=FALSE, warning=FALSE, echo=FALSE}
ggplot(Temp3,aes(x=Year,y=Ave_Temp)) + geom_point(color="black") + stat_smooth(method = "lm", col = "red")+
  labs(title = "Average Temperature changes over 20 years") + theme(plot.title = element_text(hjust = 0.5))
```

    
    2. See correlation between Temp and Lymn disease.



## Graphs made for correlation of temperature, precipitation, and # of cases

```{r}
library(readr)
library(ggplot2)
LymeTempPrec<- read_csv("./LymeTempPrec3.csv")
head(LymeTempPrec)
```


Found averages

```{r}
library(dplyr)
means<-LymeTempPrec %>%
  summarise_at(vars(-state, -full), funs(mean(., na.rm=TRUE)))
head(means)
```

##Pivoted the data

```{r}
library(tidyr)
means<- means %>%
  pivot_longer(everything(),names_to = "Measure", values_to = "Average")
head(means)
```
##Plotted average Lyme

```{r}
library(stringr)
avgLyme <- means %>% filter(str_detect(Measure, "^lyme"))
ggplot(data = avgLyme, aes(x=Measure, y=Average)) + geom_bar(stat = "identity")
```
##Plotted average Temperature
```{r}
avgTemp <- means %>%
  filter(str_detect(Measure, "^temp"))
ggplot(data = avgTemp, aes(x=Measure, y=Average)) + geom_bar(stat = "identity")
```
##Plotted average Prec
```{r}
avgPrec <- means %>%
  filter(str_detect(Measure, "^prec"))
ggplot(data = avgPrec, aes(x=Measure, y=Average)) + geom_bar(stat = "identity")
```
##Found sums
```{r}
sums<-LymeTempPrec %>%
  summarise_at(vars(-state, -full), funs(sum(., na.rm=TRUE)))
sums<- sums %>%
  pivot_longer(everything(),names_to = "Measure", values_to = "Total")
```

```{r}
sumLyme <- sums %>% filter(str_detect(Measure, "^lyme"))
ggplot(data = sumLyme, aes(x=Measure, y=Total)) + geom_bar(stat = "identity")
```
```{r}
sumLyme$Measure <- as.factor(avgLyme$Measure)
sumLyme$Measure <- factor(sumLyme$Measure, levels = c("lyme9296", "lyme9701", "lyme0206", "lyme0711"))
ggplot(sumLyme, aes(x=Measure, y=Total, color = "darkblue")) +
  geom_bar(stat = "identity")
```



##Reordered the graphs to go in chronological order
```{r}
avgLyme$Measure <- as.factor(avgLyme$Measure)
avgLyme$Measure <- factor(avgLyme$Measure, levels = c("lyme9296", "lyme9701", "lyme0206", "lyme0711"))
ggplot(avgLyme, aes(x=Measure, y=Average)) +
  geom_bar(stat = "identity")
```
```{r}
avgTemp$Measure <- as.factor(avgTemp$Measure)
avgTemp$Measure <- factor(avgTemp$Measure, levels = c("temp9296", "temp9701", "temp0206", "temp0711"))
ggplot(avgTemp, aes(x=Measure, y=Average)) +
  geom_bar(stat = "identity")
```
```{r}
avgPrec$Measure <- as.factor(avgPrec$Measure)
avgPrec$Measure <- factor(avgPrec$Measure, levels = c("prec9296", "prec9701", "prec0206", "prec0711"))
ggplot(avgPrec, aes(x=Measure, y=Average)) +
  geom_bar(stat = "identity")
```


```{r}
library(tidyverse)
LymeTempPrec2<- LymeTempPrec %>%
  select(full:temp0711)
new <- LymeTempPrec2 %>%
  pivot_longer(lyme9296:temp0711, names_to = "measure", values_to = "value")
new$date<-substr(new$measure, nchar(new$measure) - 3, nchar(new$measure))
new$measure <- substr(new$measure, 1, 4)
head(new)
```

```{r}
new <- new %>%
  pivot_wider(names_from = "measure", values_from = "value")
head(new)
```
##Lyme disease typically happens around the 60 degrees range. cleaned for better format for the chart.
```{r}
new %>%
  ggplot(aes(x=temp, y=lyme, color=date)) + geom_point()
```
##Scatterplot to show what temperatures the most cases occur at

## Answers to the questions raised

## Conclusion
